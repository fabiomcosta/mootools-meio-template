/**
 * @author: fabiomcosta
 * @version 0.9
 * Copyright (c) 2008 Fabio M. Costa http://www.meiocodigo.com
 * The MIT License (http://www.opensource.org/licenses/mit-license.php)
 */
if(typeof Meio=="undefined"){var Meio={}}(function(){var A=document.id||A;Meio.Template=new Class({Implements:Options,options:{debug:false,ignore:{},templateRegex:/\{([^{}]+)\}/g},normalizeRegex:[(/>\s+</g),"><",(/\s+(\\?>)/g),"$1",(/(<\/?)(\w+)([>\s\/])/g),function(E,D,C,B){return D+C.toLowerCase()+B},(/(<\w+\s\w+=)([^\s"'>]+)([^>]*\/?>)/g),function(E,D,C,B){return D+'"'+C+'"'+B}],initialize:function(C,B){this.TEMPLATE_DEBUG_ID="meio-template-debug";this.setOptions(B);this.template=C},matchWith:function(E){var B=null,J=false;if($type(E)=="element"){B=A(E);E=B.get("html")}else{B=new Element("div",{"html":E,styles:{"display":"none"}})}if(B.ownerDocument!==document.body){B.inject(document.body);J=true}if($type(this.options.ignore)=="object"){this.ignoreNodes(B);E=B.innerHTML;if(J){B.dispose()}}var F=this.template,H=[],I=this.normalizeRegex;for(var C=0;C<I.length;C+=2){E=E.replace(I[C],I[C+1]);F=F.replace(I[C],I[C+1])}var G=F.replace(this.options.templateRegex,function(L,K){H.push(K);return"(.*)"});var D=E.match(new RegExp(G));if(!D&&this.options.debug){this.debug(F,E)}return(D)?D.slice(1).associate(H):null},ignoreNodes:function(C){var H=this.options.ignore,G=null;for(selector in H){G=H[selector];if($type(G)=="string"){switch(G){case"*":C.getElements(selector).dispose();break;case"+":var F=C.getElements(selector);for(var D=F.length;D--;){for(var B,E=F[D].attributes.length;E--;){if((B=F[D].attributes[E])&&B.nodeValue&&B.specified&&!B.expando){F[D].removeAttribute(B.nodeName)}}}break;default:G=[G]}}if($type(G)=="array"){var F=C.getElements(selector);for(var D=F.length;D--;){for(var E=G.length;E--;){F[D].removeAttribute(G[E])}}}}},debug:function(C,B){var D="If they don't match its because you are forgetting to ignore something.\nTemplate:\n"+C+"\nCleaned string:\n"+B;(console&&console.log)?console.log(D):alert(D)}});String.implement({matchWith:function(C,B){return new Meio.Template(this,B).matchWith(C)}})})()